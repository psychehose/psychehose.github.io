
new/delete와 malloc/free의 가장 중요한 차이는 객체의 생명주기 관리입니다.

new는 메모리 할당과 함께 생성자를 호출합니다. 객체가 제대로 초기화되어 사용 가능한 상태가 됩니다. delete는 소멸자를 호출한 후 메모리를 해제합니다. 반면 malloc은 단순히 메모리만 할당하고, free는 메모리만 해제합니다. 생성자와 소멸자가 호출되지 않아서 C++ 객체에는 사용할 수 없습니다.

타입 안정성도 큰 차이입니다. new는 타입을 명시하면 자동으로 크기를 계산하고 올바른 타입의 포인터를 반환합니다. malloc은 void 포인터를 반환하므로 캐스팅이 필요하고, 크기를 직접 계산해야 합니다.

에러 처리 방식도 다릅니다. new는 실패 시 bad_alloc 예외를 던지고, malloc은 NULL을 반환합니다. 따라서 new는 try-catch로, malloc은 NULL 체크로 에러를 처리합니다.

또 하나 중요한 차이는 new/delete는 오버로딩이 가능하다는 점입니다. 클래스별로 또는 전역적으로 메모리 할당 방식을 커스터마이징할 수 있습니다. 메모리 풀이나 디버깅 기능을 추가할 때 유용합니다.

절대 하지 말아야 할 것은 malloc으로 할당한 것을 delete로 해제하거나, new로 할당한 것을 free로 해제하는 것입니다. 정의되지 않은 동작이 발생합니다.