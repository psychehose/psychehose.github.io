광원을 등지고 있을 때 오브젝트의 테두리가 밝게 빛나는 현상을 본 적이 있을것이다. 오브젝트의 가장자리(윤곽)를 따라 나타나는 조명 효과를 림라이트 또는 역광이라고 한다. 컴퓨터 그래픽스에서는 오브젝트를 배경에서 분리시켜 입체감이 증가하고, 실루엣을 강조해서 시각적 효과를 강하게 주는 효과로 이용한다.

이러한 효과는 언리얼엔진 머티리얼 에디터에서 손쉽게 만들 수 있다. Fresnel 노드를 이용해서 만드는데 프레넬이 뭔지부터 알아보자.

언리얼엔진 문서에 의하면

>프레넬 은 화각에 따라 반사되는 빛의 세기가 달라지는 현상을 설명하는 용어입니다. 예를 들어 웅덩이 위에 서서 수직으로 내려다보는 경우 수면 위에 빛 반사가 많지는 않을 것입니다. 관찰자가 머리를 움직여 웅덩이의 수면이 시선과 평행이 될수록 수면 위의 빛 반사가 점점 더 많이 보일 것입니다. 물과 유리는 모두 강한 프레넬 경향성을 띠며, 이는 정면에서 보면 상대적으로 투명해 보이고 비스듬한 각도에서 보면 빛을 더 많이 반사함을 뜻합니다.
>언리얼 엔진에서 Fresnel 머티리얼 표현식 은 표면 노멀과 카메라 방향의 내적을 기준으로 감쇠를 계산합니다. 표면 노멀이 카메라를 똑바로 가리켰을 때 출력 값은 0이며, 프레넬 이펙트가 일어나지 않음을 뜻합니다. 표면 노멀이 카메라와 직각일 때 출력 값은 1이며, 프레넬 이펙트가 완전히 일어남을 뜻합니다. 그런 다음 중앙에 음의 컬러가 없도록 결과는 [0, 1]로 범위제한됩니다. 이 개념을 보여주는 것이 다음 이미지입니다.


![[fresnel.png]]

표면 노말과 카메라 방향 벡터를 내적해서 결과가 -1이 나오면 구의 중앙이고 0이 나오면 구의 가장자리가 나온다.(노멀과 카메라 방향이 수직이기 때문에)

* 참고: 내적은 두 벡터가 얼마나 같은 방향인지 측정할 때 사용됨

다만 프레넬 노드는 내적 값을 바로 이용하지 않고 내부 에서 처리한다. 그래서 내부에서 이 내적 값을 이용해서 값을 출력한다. 프레넬 노드는 0인 경우 어두워지고 1인 경우는 밝아진다. 즉 프레넬 노드를 사용하면 림 라이트를 쉽게 구현할 수 있다.

프레넬 노드에는 3가지 머티리얼 표현식이 있다.

1. Exponenln
2. BaseReflectFractionIn
3. Normal

Exponenln은 프레넬 이펙트의 감쇠를 제어하는 입력이다. 감쇠 속도는 빠를수록 가장자리의 좁은 영역만 밝다. 그리고 급격한 밝기 변화라서 선명하고 날카로운 림라이트 효과를 줄 수 있다. 감쇠 속도가 느리다면 가장자리에서 중앙까지 부드럽게 변화한다. 그래서 자연스러운 그라데이션이 펄쳐져 넓은 영역에 걸친 부드러운 림라이트 효과를 줄 수 있다.

BaseReflectFractionIn는 표면을 정면에서 볼 때의 스페큘러 리플렉션 부분을 지정한다. 이 값을 1로 설정하면 프레넬이 사실상 비활성화된다. (중앙도 밝아져버리니까)

Normal은 노멀 맵을 입력하여 프레넬 이펙트 렌더링 방식을 변경할 수 있다. 노멀 맵은 탄젠트 스페이스에서 월드 스페이스로 변환해야한다.

골프공, 피부와 같이  울퉁불퉁하고 복잡한 림라이트를 넣으려면 Normal을 이용해야하는데 노멀 맵 텍스쳐를 바로 넣으면 안되고  TransformVector 표현식을 통해 전달해야 한다. 이를 통해 노멀 맵을 탄젠트 스페이스에서 월드 스페이스로 변환할 수 있다. 만약 이 트랜스폼을 거치지 않으면 노멀 맵은 의도한 대로 프레넬에 영향을 주지 않는다.

#### Fresnel 요약

Fresnel 노드 출력값
- 정면:  0 (어두움)
- 가장자리: 1 (밝음)
- 뒷면: 0 

즉 가장자리만 밝게 만드는 마스크를 생성한다.

#### 현실에서의 Fresnel 효과

1. 물 표면:
    - 정면에서 보면 투명 (물속이 보임)
    - 옆에서 보면 반사 (하늘이 반사됨)
2. 유리창:
    - 정면: 투명하게 안이 보임
    - 비스듬히: 반사되어 거울처럼 보임
3. 비눗방울:
    - 가장자리가 더 강하게 반사되어 밝게 보임